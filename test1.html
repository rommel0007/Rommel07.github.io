<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Test de la Primera Ley de Newton</title>
  <style>
    /* Tu estilo aquí */
  </style>
  <!-- Firebase SDKs -->
  <script src="https://www.gstatic.com/firebasejs/9.12.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.12.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.12.1/firebase-database.js"></script>
</head>
<body>

  <!-- Formulario de inicio de sesión -->
  <h1>Iniciar sesión</h1>
  <input type="text" id="username" placeholder="Nombre de usuario">
  <button id="loginBtn">Iniciar sesión</button>

  <!-- Test de la Primera Ley de Newton -->
  <div id="timer">Tiempo restante: 2:00</div>
  <div id="quiz"></div>
  <a class="button" id="generateBtn" onclick="generateQuiz()" style="display:none;">¡Realiza el intento!</a>
  <a class="button" id="finishBtn" onclick="finishQuiz()" style="display:none;">Finalizar</a>
  <div id="result"></div>

  <script>
    // Configuración de Firebase
    const firebaseConfig = {
      apiKey: "TU_API_KEY",
      authDomain: "base-de-datos-usuarios-433da.firebaseapp.com",
      projectId: "base-de-datos-usuarios-433da",
      storageBucket: "base-de-datos-usuarios-433da.firebasestorage.app",
      messagingSenderId: "563969031549",
      appId: "1:563969031549:web:66c35b0e769d73b31d2014"
    };

    // Inicializar Firebase
    const app = firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const database = firebase.database();

    let currentUser = null; // Usuario actual

    // Función para iniciar sesión
    document.getElementById('loginBtn').onclick = function() {
      const username = document.getElementById('username').value;
      if (username) {
        // Guardar el nombre de usuario y asignarlo al usuario actual
        currentUser = username;
        document.getElementById('generateBtn').style.display = 'block'; // Mostrar el botón para comenzar el test
        alert("Bienvenido " + currentUser);
      } else {
        alert("Por favor, ingresa un nombre de usuario.");
      }
    };

    // Aquí van las preguntas del test
    const questions = [
      // ... (las mismas preguntas del test 1 que ya tenías)
    ];

    // Iniciar el test
    function generateQuiz() {
      if (!currentUser) {
        alert("Debes iniciar sesión para realizar el test.");
        return;
      }

      // Aquí va el código de generación del test (lo mismo que ya tenías)
      // ...

      // Cuando termine el test, se guarda el puntaje en Firebase con el nombre del usuario
      finishQuiz();
    }

    // Función para finalizar el test y guardar los resultados
    function finishQuiz() {
      let score = 0;
      let timeSpent = "2m 00s"; // Suponiendo que el tiempo fue de 2 minutos

      // Guardar el puntaje en Firebase bajo el nombre del usuario
      const userRef = database.ref('testResults/' + currentUser); // Guarda los resultados bajo el nombre del usuario
      userRef.set({
        score: score,
        time: timeSpent,
        timestamp: new Date().toISOString()
      });

      document.getElementById('result').innerHTML = `Puntaje: ${score}/10<br>Tiempo usado: ${timeSpent}`;
    }
  </script>

</body>
</html>

